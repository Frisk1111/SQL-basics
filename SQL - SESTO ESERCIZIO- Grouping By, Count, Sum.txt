CREATE TABLE MEAL_ORDER(
  NAME VARCHAR(255),
  PRICE DOUBLE,
  CALORIES INT,
  ORDER_WHEN TIMESTAMP
  );
  
  
 INSERT INTO MEAL_ORDER(NAME, PRICE, CALORIES, ORDER_WHEN)
 VALUES("Cheesecake", 15.50, 590, DATE_ADD(NOW(), INTERVAL 9 HOUR));
 
 INSERT INTO MEAL_ORDER(NAME, PRICE, CALORIES, ORDER_WHEN)
 VALUES("Cheesecake", 15.50, 590, DATE_ADD(NOW(), INTERVAL 6 HOUR));
 
 INSERT INTO MEAL_ORDER(NAME, PRICE, CALORIES, ORDER_WHEN)
 VALUES("Cheesecake", 15.50, 590, DATE_ADD(NOW(), INTERVAL 5 HOUR));
  
 INSERT INTO MEAL_ORDER(NAME, PRICE, CALORIES, ORDER_WHEN)
 VALUES("pESTO OPasta",10.20, 490 , NOW());
  
 INSERT INTO MEAL_ORDER(NAME, PRICE, CALORIES, ORDER_WHEN)
 VALUES("OPasta",12.35, 510,DATE_ADD(NOW(),  INTERVAL 2 HOUR));
  
 INSERT INTO MEAL_ORDER(NAME, PRICE, CALORIES,ORDER_WHEN)
 VALUES("Hamburger ", 8.68, 450 , DATE_ADD(NOW(), INTERVAL 3 HOUR));
  
 INSERT INTO MEAL_ORDER(NAME, PRICE, CALORIES,ORDER_WHEN)
 VALUES("pESTO OPasta",10.20,490 , DATE_ADD(NOW(), INTERVAL 4 HOUR));
  
 INSERT INTO MEAL_ORDER(NAME, PRICE, CALORIES,ORDER_WHEN)
 VALUES("pESTO OPasta",10.20,490, DATE_ADD(NOW(), INTERVAL 5 HOUR));
  
 INSERT INTO MEAL_ORDER(NAME, PRICE, CALORIES,ORDER_WHEN)
 VALUES("Hamburger ", 8.68, 450 , DATE_ADD(NOW(), INTERVAL 1 HOUR));
  
 INSERT INTO MEAL_ORDER(NAME, PRICE, CALORIES,ORDER_WHEN)
 VALUES("OPasta",12.35, 510 , DATE_ADD(NOW(),INTERVAL 7 HOUR));



# PARTE DI SELECT
#|numeri di ordino per ogni portata|

SELECT LOWER(NAME) AS LOWER_NAME,
COUNT(*) AS MEAL_ORDER FROM MEAL_ORDER
GROUP BY LOWER(NAME);

#somma e selezione delle portate che costano più di 15€

SELECT LOWER(NAME) AS LOWER_NAME,
COUNT(*) AS TIMES_MEAL_ORDERED,
SUM(PRICE) AS TOT_REVENUE 
FROM MEAL_ORDER
WHERE PRICE > 15
GROUP BY NAME;

#così seleziono le portate che hanno più di 500 calorie e coto quante volte sono state ordinate!!

SELECT LOWER(NAME) AS LOWER_NAME,
COUNT(*) AS TIMES_MEAL_ORDERED FROM MEAL_ORDER
WHERE CALORIES > 500
GROUP BY NAME;

#COSì SELEZIONO LE PORTATE CHE CONTENGONO ALMENO UNA 's' 

SELECT LOWER(NAME) AS LOWER_NAME,
SUM(PRICE) AS TOT_REVENUE 
FROM MEAL_ORDER
WHERE NAME LIKE '%s%'
GROUP BY NAME;


# così conto quando volte le portate sono state ordinate PRIMA delle 18!!
SELECT LOWER(NAME) AS LOWER_NAME,
COUNT(*) AS TIMES_MEAL_ORDERED
FROM MEAL_ORDER
WHERE ORDER_WHEN < '2023-05-08 18:00:00'
GROUP BY NAME;
